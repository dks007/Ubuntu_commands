from elasticsearch import Elasticsearch

# Elasticsearch connection details
es_host = '10.88.22.40'
es_port = 9200
es_timeout = 600
es_username = "sstam-user"
es_password = "kGu943TgeCiGyUZPLMls"

# Create an Elasticsearch client with authentication
es = Elasticsearch(
    hosts=[{'host': es_host, 'port': es_port, 'timeout': es_timeout}],
    http_auth=(es_username, es_password),  # Corrected authentication tuple
)

# Define a search query
query = {
    "size": 5,
    "query": {
        "match_all": {}
    }
}

# Perform the search query against a specific index
index_name = "elasticsearchweu:fluentd-common-prod"  # Ensure the index name is correct
result = es.search(index=index_name, body=query)

# Process and print the result
print(result)
